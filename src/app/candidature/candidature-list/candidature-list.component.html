<div class="candidature-list-container">
  <h2 class="list-title">Liste des candidatures <span><i class="ri-file-list-3-line"></i></span></h2>

  <div class="controls-wrapper">
    <div class="filter-field-wrapper">
      <label for="statusFilter" class="filter-label">Filtrer par statut</label>
      <select id="statusFilter" class="form-input"
              [ngModel]="filter()" 
              (ngModelChange)="filter.set($event); reload()">
        <option value="">Tous</option>
        <option value="PENDING">En attente</option>
        <option value="ACCEPTED">Accepté</option>
        <option value="REFUSED">Refusé</option>
        <option value="WAITING_LIST">Liste d’attente</option>
      </select>
    </div>

    <button class="sort-button" (click)="sort()">
      <i class="ri-sort-desc"></i>
      Trier par moyenne {{ desc() ? '(desc)' : '(asc)' }}
    </button>
  </div>

  <div class="table-card shadow-lg">
    <div class="table-responsive">
      <table class="candidature-table">
        <thead>
          <tr>
            <th class="header-cell">Étudiant</th>
            <th class="header-cell">Établissement</th>
            <th class="header-cell">Offre</th>
            <th class="header-cell">Moyenne</th>
            <th class="header-cell">Date</th>
            <th class="header-cell">Statut</th>
            <th class="header-cell text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let c of items()" class="data-row">
            <td class="data-cell">{{ c.studentName }}</td>
            <td class="data-cell">{{ c.etablissementNom }}</td>
            <td class="data-cell">{{ c.offreTitre }}</td>
            <td class="data-cell">{{ c.moyenne }}</td>
            <td class="data-cell">{{ c.dateDebutMobilite | date }}</td>
            <td class="data-cell text-center">
              <i class="status-icon"
                [ngClass]="{
                  'ri-time-line status-pending': c.status === 'PENDING',
                  'ri-check-line status-active': c.status === 'ACCEPTED',
                  'ri-close-line status-inactive': c.status === 'REFUSED',
                  'ri-hourglass-2-line status-waiting': c.status === 'WAITING_LIST'
                }">
              </i>
            </td>
                        <td class="data-cell text-center">
              <button class="action-button accept-btn" (click)="accept(c)">
                <i class="ri-check-line"></i>
              </button>
              <button class="action-button refuse-btn" (click)="refuse(c)">
                <i class="ri-close-line"></i>
              </button>
              <button class="action-button hold-btn" (click)="hold(c)">
                <i class="ri-time-line"></i>
              </button>
              <button class="action-button delete-btn" (click)="del(c.id)">
                <i class="ri-delete-bin-line"></i>
              </button>
            </td>
          </tr>

          <tr *ngIf="!items() || items().length === 0">
            <td class="no-data-row" [attr.colspan]="7">
              Aucune candidature trouvée.
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
